import{defineProperty as e,objectSpread2 as t,objectWithoutProperties as r}from"../../_virtual/_rollupPluginBabelHelpers.min.mjs";import{classRegistry as o}from"../ClassRegistry.min.mjs";import{Group as n}from"./Group.min.mjs";import{LAYOUT_TYPE_REMOVED as s,LAYOUT_TYPE_ADDED as i}from"../LayoutManager/constants.min.mjs";import{log as a}from"../util/internals/console.min.mjs";import{ActiveSelectionLayoutManager as c}from"../LayoutManager/ActiveSelectionLayoutManager.min.mjs";const l=["layoutManager"];class u extends n{static getDefaults(){return t(t({},super.getDefaults()),u.ownDefaults)}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{layoutManager:o}=t,n=r(t,l);super(e,{layoutManager:null!=o?o:new c}),Object.assign(this,u.ownDefaults),this.setOptions(n)}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];"selection-order"===this.multiSelectionStacking?this.add(...t):t.forEach((e=>{const t=this._objects.findIndex((t=>t.isInFrontOf(e))),r=-1===t?this.size():t;this.insertAt(r,e)}))}canEnterGroup(e){return this.getObjects().some((t=>t.isDescendantOf(e)||e.isDescendantOf(t)))?(a("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const r=new Set;t.forEach((e=>{const{parent:t}=e;t&&r.add(t)})),e===s?r.forEach((e=>{e._onAfterObjectsChange(i,t)})):r.forEach((e=>{e._set("dirty",!0)}))}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,r,o){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,super._renderControls(e,r);const n=t(t({hasControls:!1},o),{},{forActiveSelection:!0});for(let t=0;t<this._objects.length;t++)this._objects[t]._renderControls(e,n);e.restore()}}e(u,"type","ActiveSelection"),e(u,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),o.setClass(u),o.setClass(u,"activeSelection");export{u as ActiveSelection};
//# sourceMappingURL=ActiveSelection.min.mjs.map
